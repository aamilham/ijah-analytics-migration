<div class="contact-container">
  <h2 class="contact-title">Contact Us</h2>

  <!-- Pesan Sukses -->
  <div class="alert alert-success" *ngIf="submissionSuccess">
    <i class="fas fa-check-circle"></i> Thank you! Your message has been sent successfully.
  </div>

  <!-- Pesan Error -->
  <div class="alert alert-danger" *ngIf="submissionError">
    <i class="fas fa-exclamation-circle"></i> {{ errorMessage }}
  </div>

  <form
    [formGroup]="contactForm"
    (ngSubmit)="onSubmit()"
    class="contact-form"
    novalidate
  >
    <!-- Kolom Kiri -->
    <div class="form-left">
      <fieldset class="subject-group">
        <legend>Subject</legend>
        <div class="radio-group">
          <label>
            <input type="radio" formControlName="subject" value="Question" />
            Question
          </label>
          <label>
            <input type="radio" formControlName="subject" value="Error/Bugs" />
            Error/Bugs
          </label>
          <label>
            <input type="radio" formControlName="subject" value="Wishlist" />
            Wishlist
          </label>
          <label>
            <input type="radio" formControlName="subject" value="Complaint" />
            Complaint
          </label>
          <label>
            <input type="radio" formControlName="subject" value="Suggestion" />
            Suggestion
          </label>
          <label>
            <input type="radio" formControlName="subject" value="Testimony" />
            Testimony
          </label>
          <label>
            <input type="radio" formControlName="subject" value="Other" />
            Other
          </label>
        </div>
        <div
          class="error-message"
          *ngIf="
            contactForm.get('subject')?.touched &&
            contactForm.get('subject')?.invalid
          "
        >
          Please select a subject.
        </div>
      </fieldset>

      <button 
        type="submit" 
        class="submit-button"
        [disabled]="!contactForm.valid || isSubmitting">
        <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        {{ isSubmitting ? 'Sending...' : 'Submit' }}
      </button>
    </div>

    <!-- Kolom Kanan -->
    <div class="form-right">
      <div class="input-group-inline">
        <div class="input-group">
          <label for="name">Name</label>
          <input
            type="text"
            id="name"
            formControlName="name"
            placeholder="Name"
            [ngClass]="{
              invalid:
                contactForm.get('name')?.invalid &&
                contactForm.get('name')?.touched
            }"
          />
          <div
            class="error-message"
            *ngIf="nameErrors"
          >
            {{ nameErrors }}
          </div>
        </div>

        <div class="input-group">
          <label for="affiliation">Affiliation</label>
          <input
            type="text"
            id="affiliation"
            formControlName="affiliation"
            placeholder="University, organization, company, or etc"
          />
          <div
            class="error-message"
            *ngIf="contactForm.get('affiliation')?.errors?.['pattern']"
          >
            Affiliation can only contain letters, numbers, spaces, dots and hyphens
          </div>
        </div>
      </div>

      <div class="input-group">
        <label for="email">Email</label>
        <input
          type="email"
          id="email"
          formControlName="email"
          placeholder="name@email.com"
          [ngClass]="{
            invalid:
              contactForm.get('email')?.invalid &&
              contactForm.get('email')?.touched
          }"
        />
        <div
          class="error-message"
          *ngIf="emailErrors"
        >
          {{ emailErrors }}
        </div>
      </div>

      <div class="input-group">
        <label for="message">Message</label>
        <textarea
          id="message"
          formControlName="message"
          rows="6"
          placeholder="Your message"
          [ngClass]="{
            invalid:
              contactForm.get('message')?.invalid &&
              contactForm.get('message')?.touched
          }"
        ></textarea>
        <div
          class="error-message"
          *ngIf="messageErrors"
        >
          {{ messageErrors }}
        </div>
        <small class="char-count" *ngIf="contactForm.get('message')?.value">
          {{ contactForm.get('message')?.value.length }}/500 characters
        </small>
      </div>
    </div>
  </form>

  <section class="full-width-map">
    <div class="map-container">
      <iframe 
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3963.4752229693186!2d106.79886721085063!3d-6.587698793378441!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e69c5bccacb1641%3A0x8ba4345a311eb4ee!2sTropBRC!5e0!3m2!1sen!2sid!4v1732503408472!5m2!1sen!2sid"
        width="991.07"
        height="450"
        style="border:0;"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade">
      </iframe>
    </div>
  </section>
</div>
